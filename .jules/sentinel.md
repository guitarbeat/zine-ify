## 2024-05-24 - [CRITICAL] Fix File Signature Validation for Polyglot Attacks
**Vulnerability:** The application used `text.includes('%PDF-')` within the first 1024 bytes to validate uploaded PDF files. This allowed an attacker to bypass the security check by uploading a polyglot file (e.g., a file that is both a valid PDF and a malicious executable) as long as the PDF magic bytes (`%PDF-`) were present anywhere within the allowed buffer limit.
**Learning:** `includes` only checks for the presence of a substring, not its position. While the PDF specification nominally allows the signature to appear within the first 1024 bytes to accommodate some legacy tools, enforcing it strictly at offset 0 (`startsWith`) significantly mitigates polyglot risks on the web without impacting most valid generated PDFs today.
**Prevention:** Always use `startsWith('%PDF-')` for magic byte validation of files where strict formatting is expected, especially when dealing with uploaded content.