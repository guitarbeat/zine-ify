{"version":3,"file":"index-DXgwWANa.js","sources":["../../src/js/utils.js","../../node_modules/.pnpm/pdfjs-dist@5.4.624/node_modules/pdfjs-dist/build/pdf.worker.min.mjs?url","../../src/js/pdf-processor.js","../../node_modules/.pnpm/mitt@3.0.1/node_modules/mitt/dist/mitt.mjs","../../src/js/config.js","../../src/js/toast.js","../../src/js/zine-ui.js","../../src/assets/reference-back-side.jpg","../../src/js/main.js"],"sourcesContent":["// Modern utility functions for the PDF Zine Maker\n\n/**\n * Debounce function to limit how often a function can be called\n * @param {Function} func - Function to debounce\n * @param {number} wait - Wait time in milliseconds\n * @returns {Function} Debounced function\n */\nexport function debounce(func, wait) {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n}\n\n/**\n * Check if a value is a valid number\n * @param {*} value - Value to check\n * @returns {boolean} True if value is a number\n */\nexport function isNumber(value) {\n  return typeof value === 'number' && !isNaN(value) && isFinite(value);\n}\n\n/**\n * Format file size in human readable format\n * @param {number} bytes - File size in bytes\n * @returns {string} Formatted file size\n */\nexport function formatFileSize(bytes) {\n  if (!isNumber(bytes)) { return '0 B'; }\n  if (bytes === 0) { return '0 B'; }\n\n  const units = ['B', 'KB', 'MB', 'GB'];\n  let size = bytes;\n  let unitIndex = 0;\n\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024;\n    unitIndex++;\n  }\n\n  return `${size.toFixed(1)} ${units[unitIndex]}`;\n}\n\n/**\n * Create a promise that resolves after a delay\n * @param {number} ms - Delay in milliseconds\n * @returns {Promise} Promise that resolves after the delay\n */\nexport function delay(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n","export default \"__VITE_ASSET__BzS7jifq__\"","// Modern PDF processing class\n\nimport * as pdfjsLib from 'pdfjs-dist';\nimport { formatFileSize } from './utils.js';\nimport pdfWorker from 'pdfjs-dist/build/pdf.worker.min.mjs?url';\n\nexport class PDFProcessor {\n  constructor() {\n    this.pdf = null;\n    this.isProcessing = false;\n  }\n\n  /**\n   * Initialize PDF.js worker\n   */\n  async initialize() {\n    pdfjsLib.GlobalWorkerOptions.workerSrc = pdfWorker;\n  }\n\n  /**\n   * Validate PDF file\n   * @param {File} file - PDF file to validate\n   * @returns {Object} Validation result\n   */\n  validateFile(file) {\n    const errors = [];\n\n    if (!file) {\n      errors.push('No file selected');\n      return { valid: false, errors };\n    }\n\n    if (file.type !== 'application/pdf') {\n      errors.push('Please select a PDF file');\n    }\n\n    const maxSize = 250 * 1024 * 1024; // 250MB\n    if (file.size > maxSize) {\n      errors.push(`File too large (${formatFileSize(file.size)}). Maximum size is ${formatFileSize(maxSize)}`);\n    }\n\n    if (file.size === 0) {\n      errors.push('File appears to be empty');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors\n    };\n  }\n\n  /**\n   * Load PDF from file\n   * @param {File} file - PDF file to load\n   * @param {Function} onProgress - Progress callback\n   * @returns {Promise<Object>} PDF loading result\n   */\n  async loadPDF(file, onProgress = null) {\n    if (this.isProcessing) {\n      throw new Error('PDF processing already in progress');\n    }\n\n    this.isProcessing = true;\n\n    try {\n      const validation = this.validateFile(file);\n      if (!validation.valid) {\n        throw new Error(validation.errors.join('. '));\n      }\n\n      onProgress?.('Reading PDF file...');\n\n      // Security check: Validate file signature\n      const isValidSignature = await this.validateFileSignature(file);\n      if (!isValidSignature) {\n        throw new Error('Invalid file signature. Please select a valid PDF file.');\n      }\n\n      // Use Blob URL instead of reading entire file into ArrayBuffer\n      // This saves memory and prevents blocking the main thread\n      this.fileUrl = URL.createObjectURL(file);\n\n      onProgress?.('Processing PDF...');\n\n      // Add timeout to PDF loading\n      const loadingPromise = pdfjsLib.getDocument({\n        url: this.fileUrl,\n        verbosity: 0 // Reduce console output\n      }).promise;\n\n      const timeoutPromise = new Promise((_, reject) =>\n        setTimeout(() => reject(new Error('PDF loading timed out')), 60000)\n      );\n\n      this.pdf = await Promise.race([loadingPromise, timeoutPromise]);\n\n      const numPages = this.pdf.numPages;\n\n      if (numPages === 0) {\n        throw new Error('PDF appears to be empty or corrupted');\n      }\n\n      return {\n        pdf: this.pdf,\n        numPages,\n        fileName: file.name,\n        fileSize: file.size\n      };\n\n    } catch (error) {\n      console.error('PDF loading error:', error);\n      throw this.handlePDFError(error);\n    } finally {\n      this.isProcessing = false;\n    }\n  }\n\n  /**\n   * Validate file signature (magic bytes) to ensure it's a PDF\n   * @param {File} file - File to validate\n   * @returns {Promise<boolean>} True if file signature matches PDF\n   */\n  async validateFileSignature(file) {\n    // Check first 1024 bytes for %PDF-\n    // PDF 1.7 Spec: The header line shall be the first line of a PDF file.\n    // \"A PDF file shall begin with the 5 characters %PDF- followed by a version number\"\n    // However, some implementations allow it within first 1024 bytes.\n    const HEADER_LIMIT = 1024;\n    const slice = file.slice(0, HEADER_LIMIT);\n    const buffer = await slice.arrayBuffer();\n    const data = new Uint8Array(buffer);\n    const decoder = new TextDecoder();\n    const text = decoder.decode(data);\n    return text.includes('%PDF-');\n  }\n\n  /**\n   * Render PDF page to canvas\n   * @param {number} pageNum - Page number to render\n   * @param {Function} onProgress - Progress callback\n   * @returns {Promise<HTMLCanvasElement>} Rendered canvas\n   */\n  async renderPage(pageNum, onProgress = null) {\n    if (!this.pdf) {\n      throw new Error('No PDF loaded');\n    }\n\n    try {\n      onProgress?.(`Rendering page ${pageNum}...`);\n\n      const page = await this.pdf.getPage(pageNum);\n      // Reduced scale for better performance and smaller data URLs\n      const scale = 1.5; // Balanced quality vs performance\n      const viewport = page.getViewport({ scale });\n      const width = Math.floor(viewport.width);\n      const height = Math.floor(viewport.height);\n\n      // Create new canvas for each page to allow parallel processing\n      const canvas = document.createElement('canvas');\n      const context = canvas.getContext('2d', { alpha: false });\n      canvas.width = width;\n      canvas.height = height;\n\n      // Fill background white\n      context.fillStyle = '#ffffff';\n      context.fillRect(0, 0, canvas.width, canvas.height);\n\n      // Render page to canvas\n      const renderContext = {\n        canvasContext: context,\n        viewport,\n        background: 'white'\n      };\n\n      await page.render(renderContext).promise;\n\n      return canvas;\n\n    } catch (error) {\n      console.error(`Failed to render page ${pageNum}:`, error);\n      throw new Error(`Failed to render page ${pageNum}`, { cause: error });\n    }\n  }\n\n  /**\n   * Convert canvas to Blob URL for performance\n   * @param {HTMLCanvasElement} canvas - Canvas to convert\n   * @returns {Promise<string>} Blob URL\n   */\n  async canvasToBlob(canvas) {\n    return new Promise((resolve) => {\n      canvas.toBlob((blob) => {\n        const url = URL.createObjectURL(blob);\n        resolve(url);\n      }, 'image/jpeg', 0.8);\n    });\n  }\n\n  /**\n   * Revoke a Blob URL to free memory\n   * @param {string} url - Blob URL to revoke\n   */\n  revokeBlobUrl(url) {\n    if (url && url.startsWith('blob:')) {\n      URL.revokeObjectURL(url);\n    }\n  }\n\n  /**\n   * Convert canvas to data URL (legacy/fallback)\n   * @param {HTMLCanvasElement} canvas - Canvas to convert\n   * @param {string} format - Image format ('image/png' or 'image/jpeg')\n   * @param {number} quality - Image quality (0-1, only for JPEG)\n   * @returns {string} Data URL\n   */\n  canvasToDataURL(canvas, format = 'image/jpeg', quality = 0.85) {\n    try {\n      // Use JPEG for smaller file sizes, PNG as fallback\n      const dataUrl = canvas.toDataURL(format, quality);\n      return dataUrl;\n    } catch (error) {\n      console.warn(`Failed to generate ${format}, falling back to PNG:`, error);\n      // Fallback to PNG if JPEG fails\n      return canvas.toDataURL('image/png', 1.0);\n    }\n  }\n\n  /**\n   * Handle PDF-specific errors\n   * @param {Error} error - Original error\n   * @returns {Error} Processed error\n   */\n  handlePDFError(error) {\n    const message = error.message || 'Unknown error';\n\n    if (message.includes('timed out')) {\n      return new Error('PDF loading timed out. The file may be corrupted or too large.');\n    }\n\n    if (message.includes('corrupted') || message.includes('InvalidPDFException')) {\n      return new Error('The PDF file appears to be corrupted or invalid.');\n    }\n\n    if (message.includes('password') || message.includes('protected')) {\n      return new Error('The PDF file is password-protected.');\n    }\n\n    if (message.includes('not loaded') || message.includes('MissingPDFException')) {\n      return new Error('PDF.js library failed to load. Please refresh the page.');\n    }\n\n    return new Error(`PDF processing failed: ${message}`);\n  }\n\n  /**\n   * Clean up resources\n   */\n  cleanup() {\n    if (this.pdf) {\n      this.pdf.destroy();\n      this.pdf = null;\n    }\n    if (this.fileUrl) {\n      URL.revokeObjectURL(this.fileUrl);\n      this.fileUrl = null;\n    }\n    this.isProcessing = false;\n  }\n}","export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i?i.push(e):n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&(e?i.splice(i.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var i=n.get(t);i&&i.slice().map(function(n){n(e)}),(i=n.get(\"*\"))&&i.slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.mjs.map\n","export const PAPER_SIZES = {\n    a4: { label: 'A4 (210 × 297 mm)', width: 210, height: 297 },\n    a3: { label: 'A3 (297 × 420 mm)', width: 297, height: 420 },\n    letter: { label: 'Letter (8.5 × 11 in)', width: 215.9, height: 279.4 },\n    legal: { label: 'Legal (8.5 × 14 in)', width: 215.9, height: 355.6 },\n    a5: { label: 'A5 (148 × 210 mm)', width: 148, height: 210 }\n};\n\nexport const ORIENTATIONS = {\n    LANDSCAPE: 'landscape',\n    PORTRAIT: 'portrait'\n};\n\n/**\n * Zine template definitions\n * layout: Array of [pageNumber, isUpsideDown] tuples in grid order (row by row)\n */\nexport const ZINE_TEMPLATES = {\n    'mini-8': {\n        label: '8-Page Mini-Zine',\n        pages: 8,\n        grid: { rows: 2, cols: 4 },\n        // Grid order: row by row, left to right\n        layout: [\n            { page: 5, upsideDown: false }, { page: 4, upsideDown: true },\n            { page: 3, upsideDown: true }, { page: 2, upsideDown: true },\n            { page: 6, upsideDown: false }, { page: 7, upsideDown: false },\n            { page: 8, upsideDown: false }, { page: 1, upsideDown: false }\n        ],\n        gridAreas: `\n            \"page5 page4 page3 page2\"\n            \"page6 page7 page8 page1\"\n        `,\n        upsideDownPages: [2, 3, 4, 5],\n        cutLines: {\n            horizontal: { afterRow: 1 } // Cut between row 1 and 2\n        }\n    },\n    'accordion-16': {\n        label: '16-Page Accordion',\n        pages: 16,\n        grid: { rows: 4, cols: 4 },\n        layout: [\n            { page: 4, upsideDown: true }, { page: 3, upsideDown: true },\n            { page: 2, upsideDown: true }, { page: 1, upsideDown: true },\n            { page: 5, upsideDown: false }, { page: 6, upsideDown: false },\n            { page: 7, upsideDown: false }, { page: 8, upsideDown: false },\n            { page: 12, upsideDown: true }, { page: 11, upsideDown: true },\n            { page: 10, upsideDown: true }, { page: 9, upsideDown: true },\n            { page: 13, upsideDown: false }, { page: 14, upsideDown: false },\n            { page: 15, upsideDown: false }, { page: 16, upsideDown: false }\n        ],\n        gridAreas: `\n            \"page4 page3 page2 page1\"\n            \"page5 page6 page7 page8\"\n            \"page12 page11 page10 page9\"\n            \"page13 page14 page15 page16\"\n        `,\n        upsideDownPages: [1, 2, 3, 4, 9, 10, 11, 12],\n        // Cut lines for accordion fold - vertical cuts on left and right edges\n        cutLines: {\n            leftEdge: { rows: [0, 1, 2] },   // Cut through rows 1-3, leave row 4 intact\n            rightEdge: { rows: [0, 1, 2] }  // Same on right side\n        },\n        description: '1 sheet, 4×4 grid. Cut along edges then fold accordion-style.'\n    },\n    'dual-16': {\n        label: '16-Page Dual Sheets',\n        pages: 16,\n        sheets: 2, // Uses 2 separate 8-page mini-zine sheets\n        grid: { rows: 2, cols: 4 },\n        description: '2 sheets, each folded like an 8-page zine.'\n    }\n};\n","// Modern toast notification system\n\nclass Toast {\n  constructor() {\n    this.container = null;\n    this.init();\n  }\n\n  init() {\n    // Check if container already exists\n    this.container = document.getElementById('toast-container');\n\n    // Create toast container if it doesn't exist\n    if (!this.container) {\n      this.container = document.createElement('div');\n      this.container.id = 'toast-container';\n      this.container.className = 'toast-container fixed bottom-6 right-6 z-[300] flex flex-col gap-4 font-typewriter pointer-events-none';\n      document.body.appendChild(this.container);\n    }\n\n    // Always ensure accessible attributes\n    this.container.setAttribute('aria-live', 'polite');\n    this.container.setAttribute('aria-atomic', 'true');\n    this.container.setAttribute('role', 'region');\n    this.container.setAttribute('aria-label', 'Notifications');\n  }\n\n  /**\n   * Show a toast notification\n   * @param {string} type - Toast type: 'success', 'error', 'warning', 'info'\n   * @param {string} title - Toast title\n   * @param {string} message - Toast message (optional)\n   * @param {number} duration - Duration in milliseconds (default: 5000)\n   */\n  show(type, title, message = '', duration = 5000) {\n    const toast = document.createElement('div');\n    toast.className = `toast toast-${type}`;\n\n    // Dynamic role based on type\n    const role = type === 'error' ? 'alert' : 'status';\n    toast.setAttribute('role', role);\n\n    const icon = this.getIcon(type);\n    // Create structure securely to prevent XSS\n    const iconDiv = document.createElement('div');\n    iconDiv.className = 'toast-icon';\n    iconDiv.innerHTML = icon; // Icons are trusted SVGs from getIcon()\n\n    const contentDiv = document.createElement('div');\n    contentDiv.className = 'toast-content';\n\n    const titleDiv = document.createElement('div');\n    titleDiv.className = 'toast-title';\n    titleDiv.textContent = title; // Secure: textContent escapes HTML\n    contentDiv.appendChild(titleDiv);\n\n    if (message) {\n      const messageDiv = document.createElement('div');\n      messageDiv.className = 'toast-message';\n      messageDiv.textContent = message; // Secure: textContent escapes HTML\n      contentDiv.appendChild(messageDiv);\n    }\n\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'toast-close';\n    closeBtn.setAttribute('aria-label', 'Close notification');\n    closeBtn.innerHTML = '&times;'; // Safe entity\n    closeBtn.addEventListener('click', () => this.remove(toast));\n\n    toast.appendChild(iconDiv);\n    toast.appendChild(contentDiv);\n    toast.appendChild(closeBtn);\n\n    this.container.appendChild(toast);\n\n    // Auto remove after duration\n    if (duration > 0) {\n      setTimeout(() => {\n        if (toast.parentNode) {\n          this.remove(toast);\n        }\n      }, duration);\n    }\n\n    // Animate in\n    requestAnimationFrame(() => {\n      toast.classList.add('toast-visible');\n      // Add slight random rotation for chaos\n      const rotation = Math.random() * 4 - 2;\n      toast.style.transform = `translateX(0) rotate(${rotation}deg)`;\n    });\n\n    return toast;\n  }\n\n  /**\n   * Remove a toast notification\n   * @param {Element} toast - Toast element to remove\n   */\n  remove(toast) {\n    toast.classList.remove('toast-visible');\n    setTimeout(() => {\n      if (toast.parentNode) {\n        toast.parentNode.removeChild(toast);\n      }\n    }, 300); // Match CSS transition duration\n  }\n\n  /**\n   * Get icon SVG for toast type\n   * @param {string} type - Toast type\n   * @returns {string} SVG icon HTML\n   */\n  getIcon(type) {\n    const icons = {\n      success: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"/>\n        <polyline points=\"22,4 12,14.01 9,11.01\"/>\n      </svg>`,\n      error: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n        <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"/>\n        <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"/>\n      </svg>`,\n      warning: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/>\n        <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/>\n        <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\n      </svg>`,\n      info: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n        <path d=\"M12 16v-4\"/>\n        <path d=\"M12 8h.01\"/>\n      </svg>`\n    };\n    return icons[type] || icons.info;\n  }\n\n  // Convenience methods\n  success(title, message, duration) {\n    return this.show('success', title, message, duration);\n  }\n\n  error(title, message, duration) {\n    return this.show('error', title, message, duration);\n  }\n\n  warning(title, message, duration) {\n    return this.show('warning', title, message, duration);\n  }\n\n  info(title, message, duration) {\n    return this.show('info', title, message, duration);\n  }\n}\n\n// Export singleton instance\nexport const toast = new Toast();","// Modern UI management class\nimport mitt from 'mitt';\nimport { PAPER_SIZES, ZINE_TEMPLATES } from './config.js';\nimport { toast } from './toast.js';\nimport { debounce } from './utils.js';\n\nexport class UIManager {\n  constructor() {\n    this.emitter = mitt();\n    this.elements = {};\n    this.paperSize = 'a4';\n    this.orientation = 'landscape';\n    this.init();\n  }\n\n  /**\n   * Initialize UI elements and event listeners\n   */\n  init() {\n    this.cacheElements();\n    this.renderPaperSizeOptions();\n    this.loadSettings();\n    this.updatePreviewLayout();\n    this.setupEventListeners();\n\n    // Ensure preview is visible and enabled on load\n    if (this.elements.previewArea) {\n      this.elements.previewArea.classList.remove('opacity-50', 'pointer-events-none');\n    }\n  }\n\n\n  /**\n   * Cache DOM elements for performance\n   */\n  cacheElements() {\n    const $ = (selector) => document.querySelector(selector);\n\n    this.elements = {\n      // Main Containers\n      uploadZone: $('#upload-zone'),\n      previewArea: $('#preview-area'),\n      actionButtons: $('#action-buttons'),\n      previewDescription: $('#preview-description'),\n      zineSheetsContainer: $('#zine-sheets-container'),\n\n      // Interactions\n      printBtn: $('#printBtn'),\n      exportPdfBtn: $('#exportPdfBtn'),\n      pdfUpload: $('#pdf-upload'),\n      uploadStatus: $('#upload-status'),\n\n      // Progress\n      progressContainer: $('#progress-container'),\n      progressFill: $('#progress-fill'),\n      progressText: $('#progress-text'),\n      progressSubtext: $('#progress-subtext'),\n\n      // Settings\n      paperSizeSelect: $('#paper-size-select'),\n      orientationSelect: $('#orientation-select'),\n      pageNumbersCheckbox: $('#show-page-numbers'),\n\n      // Toast\n      toastContainer: $('#toast-container'),\n\n      // Zine Tabs\n      zineTabs: $('#zine-tabs'),\n      zineTab1: $('#zine-tab-1'),\n      zineTab2: $('#zine-tab-2'),\n\n      gridRows: $('#grid-rows'),\n      gridCols: $('#grid-cols'),\n      gridTotal: $('#grid-total'),\n\n      // Unused Pages Bucket\n      unusedSection: $('#unused-pages-section'),\n      unusedGrid: $('#unused-grid')\n    };\n\n  }\n\n\n\n  /**\n   * Render paper size options from constants\n   */\n  renderPaperSizeOptions() {\n    if (!this.elements.paperSizeSelect) { return; }\n\n    this.elements.paperSizeSelect.innerHTML = Object.entries(PAPER_SIZES)\n      .map(([id, data]) => `<option value=\"${id}\">${data.label}</option>`)\n      .join('');\n  }\n\n  /**\n   * Setup event listeners\n   */\n  setupEventListeners() {\n    // Settings\n    this.elements.paperSizeSelect?.addEventListener('change', (e) => this.updatePaperSize(e.target.value));\n    this.elements.orientationSelect?.addEventListener('change', (e) => this.updateOrientation(e.target.value));\n    this.elements.pageNumbersCheckbox?.addEventListener('change', (e) => this.togglePageNumbers(e.target.checked));\n\n    // Action Buttons\n    this.elements.printBtn?.addEventListener('click', () => this.emitter.emit('print'));\n    this.elements.exportPdfBtn?.addEventListener('click', () => this.emitter.emit('export'));\n\n    // Upload interactions\n    this.elements.uploadZone?.addEventListener('click', () => this.triggerFileUpload());\n    this.elements.uploadZone?.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        this.triggerFileUpload();\n      }\n    });\n    this.elements.uploadZone?.addEventListener('dragover', (e) => this.handleDragOver(e));\n    this.elements.uploadZone?.addEventListener('dragleave', (e) => this.handleDragLeave(e));\n    this.elements.uploadZone?.addEventListener('drop', (e) => this.handleFileDrop(e));\n\n    this.elements.pdfUpload?.addEventListener('change', (e) => {\n      const file = e.target.files[0];\n      if (file) { this.emitter.emit('fileSelected', file); }\n    });\n\n\n    // Grid size inputs\n    // Debounce the grid resize event to prevent expensive DOM regeneration on every keystroke\n    const updateGridSize = debounce((rows, cols) => {\n      this.emitter.emit('gridSizeChanged', { rows, cols });\n    }, 300);\n\n    const handleGridChange = () => {\n      const rows = parseInt(this.elements.gridRows?.value) || 2;\n      const cols = parseInt(this.elements.gridCols?.value) || 4;\n      if (this.elements.gridTotal) {\n        this.elements.gridTotal.textContent = `(${rows * cols} pages)`;\n      }\n      updateGridSize(rows, cols);\n    };\n    const debouncedHandleGridChange = debounce(handleGridChange, 300);\n    this.elements.gridRows?.addEventListener('input', debouncedHandleGridChange);\n    this.elements.gridCols?.addEventListener('input', debouncedHandleGridChange);\n\n    // Keyboard\n    document.addEventListener('keydown', (e) => this.handleKeyboard(e));\n  }\n\n\n\n\n\n  /**\n   * Set the UI to \"ready\" state (enable preview area and action buttons)\n   */\n  setReady(ready, description = null) {\n    if (ready) {\n      this.elements.previewArea?.classList.remove('opacity-30', 'pointer-events-none');\n      this.elements.actionButtons?.classList.remove('hidden');\n    } else {\n      this.elements.previewArea?.classList.add('opacity-30', 'pointer-events-none');\n      this.elements.actionButtons?.classList.add('hidden');\n    }\n\n    if (description && this.elements.previewDescription) {\n      this.elements.previewDescription.textContent = description;\n    }\n  }\n\n  /**\n   * Update progress bar\n   */\n  updateProgress(percent) {\n    if (this.elements.progressFill) {\n      this.elements.progressFill.style.width = `${percent}%`;\n    }\n  }\n\n  /**\n   * Update status message\n   */\n  setStatus(message, type = 'info') {\n    if (this.elements.uploadStatus) {\n      this.elements.uploadStatus.textContent = message;\n      this.elements.uploadStatus.className = `text-[11px] uppercase font-bold tracking-wider ${type === 'error' ? 'text-red-500' : type === 'success' ? 'text-green-500' : 'text-gray-400'\n        }`;\n    }\n  }\n\n  /**\n   * Generate sheets and page placeholders\n   * @param {number} numPages - Number of pages in the PDF\n   * @param {string} templateType - Template type: 'mini-8', 'dual-16', or 'accordion-16'\n   */\n  generateLayout(numPages = 8, templateType = null) {\n    if (!this.elements.zineSheetsContainer) { return; }\n    this.elements.zineSheetsContainer.innerHTML = '';\n\n    // Auto-detect template if not specified\n    if (!templateType) {\n      if (numPages > 8) {\n        templateType = 'accordion-16'; // Default to accordion for 9-16 pages\n      } else {\n        templateType = 'mini-8';\n      }\n    }\n\n    this.currentTemplate = templateType;\n    const template = ZINE_TEMPLATES[templateType];\n\n    if (!template) {\n      console.error(`Unknown template: ${templateType}`);\n      return;\n    }\n\n    // For accordion-16, we use a single sheet with 4x4 grid\n    if (templateType === 'accordion-16') {\n      this.generateAccordionLayout(template);\n    } else {\n      // Mini-8 or dual-16 (two 8-page sheets)\n      this.generateMiniZineLayout(numPages, template);\n    }\n\n    this.updatePreviewLayout();\n\n    // Ensure preview is visible and enabled\n    if (this.elements.previewArea) {\n      this.elements.previewArea.classList.remove('opacity-50', 'pointer-events-none');\n    }\n  }\n\n\n  /**\n   * Generate a custom grid layout with specified rows and columns\n   */\n  generateCustomGrid(rows, cols, totalPDFPages = 0) {\n    this.elements.zineSheetsContainer.innerHTML = '';\n    const totalSlots = rows * cols;\n    // Ensure we account for all pages if totalPDFPages is larger\n    const actualPages = Math.max(totalSlots, totalPDFPages);\n\n    const sheetWrapper = document.createElement('div');\n    sheetWrapper.className = 'print-sheet w-full p-0 relative overflow-hidden rounded-sm';\n    sheetWrapper.setAttribute('data-sheet', 1);\n    sheetWrapper.setAttribute('data-template', `custom-${rows}x${cols}`);\n\n    const grid = document.createElement('div');\n    grid.className = 'zine-grid';\n    grid.id = 'zine-grid-sheet-1';\n    grid.style.display = 'grid';\n    grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;\n    grid.style.gridTemplateRows = `repeat(${rows}, 1fr)`;\n    grid.style.gridTemplateAreas = 'none'; // Critical: override default CSS areas\n\n    for (let i = 0; i < totalSlots; i++) {\n      const pageNum = i + 1;\n      const cell = document.createElement('div');\n      cell.className = 'page-cell h-full w-full bg-white relative flex items-center justify-center overflow-hidden transition-all duration-200';\n      cell.setAttribute('data-page-index', i);\n      cell.setAttribute('data-page', pageNum);\n      cell.setAttribute('draggable', 'true');\n\n      const labelText = pageNum === 1 ? 'Cover' : (pageNum === totalSlots ? 'Back' : `Page ${pageNum}`);\n\n      cell.innerHTML = `\n        <span class=\"page-label centered absolute top-2 left-2 px-2 py-1 bg-black text-white text-[10px] font-black rounded uppercase z-10 shadow-[2px_2px_0_black]\">${labelText}</span>\n        <button class=\"flip-btn absolute top-2 right-2 w-8 h-8 bg-white hover:bg-yellow-300 border-2 border-black flex items-center justify-center text-sm z-10 shadow-[2px_2px_0_black] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all focus-visible:ring-2 focus-visible:ring-black focus-visible:outline-none\" title=\"Flip ${labelText}\" aria-label=\"Rotate ${labelText} 180 degrees\">\n            <span class=\"material-symbols-outlined text-lg font-bold\">rotate_right</span>\n        </button>\n        <div class=\"page-placeholder text-gray-200 text-xs font-black uppercase tracking-widest\">Empty</div>\n        <img alt=\"Page ${pageNum}\" class=\"page-content-img w-full h-full object-contain hidden transition-transform duration-300 ease-in-out\" draggable=\"false\" />\n      `;\n\n      this.setupDragAndDrop(cell);\n      this.setupFlipButton(cell);\n      grid.appendChild(cell);\n    }\n\n    sheetWrapper.appendChild(grid);\n    this.elements.zineSheetsContainer.appendChild(sheetWrapper);\n\n    // Generate bucket for extra pages\n    this.generateUnusedBucket(totalSlots, actualPages);\n\n    this.updatePreviewLayout();\n  }\n\n  generateUnusedBucket(startIndex, totalPages) {\n    const { unusedSection, unusedGrid } = this.elements;\n    if (!unusedSection || !unusedGrid) { return; }\n\n    unusedGrid.innerHTML = '';\n\n    // If no extra pages, hide the section\n    if (startIndex >= totalPages) {\n      unusedSection.classList.add('hidden');\n      return;\n    }\n\n    unusedSection.classList.remove('hidden');\n\n    // Create slots for remaining pages\n    for (let i = startIndex; i < totalPages; i++) {\n      const cell = document.createElement('div');\n      // Using similar but distinct styling for bucket items\n      cell.className = 'page-cell bg-white aspect-[1/1.414] relative rounded-lg shadow-sm border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden cursor-grab active:cursor-grabbing hover:border-blue-500 transition-colors duration-200';\n      cell.setAttribute('data-page-index', i);\n      cell.draggable = true;\n\n      const img = document.createElement('img');\n      img.className = 'page-content-img w-full h-full object-contain hidden pointer-events-none';\n      img.draggable = false;\n\n      const label = document.createElement('div');\n      label.className = 'absolute top-1 left-1 bg-gray-500 text-white text-[8px] px-1.5 py-0.5 rounded-sm font-bold z-10';\n      label.textContent = `#${i + 1}`;\n\n      const placeholder = document.createElement('div');\n      placeholder.className = 'text-[10px] uppercase font-bold text-gray-300 select-none';\n      placeholder.textContent = 'Unused';\n\n      cell.appendChild(label);\n      cell.appendChild(placeholder);\n      cell.appendChild(img);\n\n      this.setupDragAndDrop(cell);\n      unusedGrid.appendChild(cell);\n    }\n  }\n\n  /**\n   * Generate the accordion-16 layout (single sheet, 4x4 grid)\n   */\n  generateAccordionLayout(template) {\n    const sheetWrapper = document.createElement('div');\n    sheetWrapper.className = 'print-sheet w-full p-0 relative overflow-hidden rounded-sm';\n    sheetWrapper.setAttribute('data-sheet', 1);\n    sheetWrapper.setAttribute('data-template', 'accordion-16');\n\n    const grid = document.createElement('div');\n    grid.className = 'zine-grid accordion-16';\n    grid.id = 'zine-grid-sheet-1';\n    grid.style.display = 'grid';\n    grid.style.gridTemplateColumns = 'repeat(4, 1fr)';\n    grid.style.gridTemplateRows = 'repeat(4, 1fr)';\n\n    // Generate cells based on template layout\n    template.layout.forEach((item) => {\n      const cell = document.createElement('div');\n      cell.className = 'page-cell h-full w-full bg-white relative flex items-center justify-center overflow-hidden';\n      cell.setAttribute('data-page-index', item.page - 1);\n      cell.setAttribute('data-page', item.page);\n      cell.setAttribute('draggable', 'true');\n\n      const labelText = item.page === 1 ? 'Cover' : (item.page === 16 ? 'Back' : `Page ${item.page}`);\n\n      cell.innerHTML = `\n        <span class=\"page-label centered absolute top-2 left-2 px-2 py-1 bg-black text-white text-[10px] font-black rounded uppercase z-10 shadow-[2px_2px_0_black]\">${labelText}</span>\n        <button class=\"flip-btn absolute top-2 right-2 w-8 h-8 bg-white hover:bg-yellow-300 border-2 border-black flex items-center justify-center text-sm z-10 shadow-[2px_2px_0_black] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all focus-visible:ring-2 focus-visible:ring-black focus-visible:outline-none\" title=\"Flip ${labelText}\" aria-label=\"Rotate ${labelText} 180 degrees\">\n            <span class=\"material-symbols-outlined text-lg font-bold\">rotate_right</span>\n        </button>\n        <div class=\"page-placeholder text-gray-200 text-xs font-black uppercase tracking-widest\">Empty</div>\n        <img alt=\"Page ${item.page}\" class=\"page-content-img w-full h-full object-contain hidden transition-transform duration-300 ease-in-out\" draggable=\"false\" />\n      `;\n\n      this.setupDragAndDrop(cell);\n      this.setupFlipButton(cell);\n      grid.appendChild(cell);\n    });\n\n    sheetWrapper.appendChild(grid);\n\n    // Add fold guidelines for accordion\n    const guidelines = `\n      <div class=\"absolute top-1/4 left-0 w-full border-t border-blue-400/30 pointer-events-none\"></div>\n      <div class=\"absolute top-1/2 left-0 w-full border-t border-blue-400/30 pointer-events-none\"></div>\n      <div class=\"absolute top-3/4 left-0 w-full border-t border-blue-400/30 pointer-events-none\"></div>\n      <div class=\"absolute top-0 left-1/4 h-full border-l border-blue-400/30 pointer-events-none\"></div>\n      <div class=\"absolute top-0 left-1/2 h-full border-l border-blue-400/30 pointer-events-none\"></div>\n      <div class=\"absolute top-0 left-3/4 h-full border-l border-blue-400/30 pointer-events-none\"></div>\n    `;\n    sheetWrapper.insertAdjacentHTML('beforeend', guidelines);\n\n    // Cut lines removed per user request\n\n    this.elements.zineSheetsContainer.appendChild(sheetWrapper);\n  }\n\n  /**\n   * Generate mini-zine layout (8-page single or dual sheets)\n   */\n  generateMiniZineLayout(numPages, _template) {\n    const numSheets = numPages > 8 ? 2 : 1;\n\n    for (let s = 1; s <= numSheets; s++) {\n      const sheetWrapper = document.createElement('div');\n      sheetWrapper.className = 'print-sheet w-full p-0 relative overflow-hidden rounded-sm';\n      sheetWrapper.setAttribute('data-sheet', s);\n\n      const grid = document.createElement('div');\n      grid.className = 'zine-grid';\n      grid.id = `zine-grid-sheet-${s}`;\n      grid.style.display = 'grid';\n      grid.style.gridTemplateColumns = 'repeat(4, 1fr)';\n      grid.style.gridTemplateRows = 'repeat(2, 1fr)';\n\n      for (let i = 1; i <= 8; i++) {\n        const pageIdx = (s - 1) * 8 + i;\n        const cell = document.createElement('div');\n        cell.className = 'page-cell h-full w-full bg-white relative flex items-center justify-center overflow-hidden';\n        cell.setAttribute('data-page-index', pageIdx - 1);\n        cell.setAttribute('data-page', i);\n        cell.setAttribute('draggable', 'true');\n\n        const labelText = i === 1 ? 'Cover' : (i === 8 ? 'Back' : `Page ${i}`);\n        const sheetLabel = numSheets > 1 ? ` <span class=\"opacity-50 text-[8px] ml-1\">(Sheet ${s})</span>` : '';\n\n        const accessibleLabelText = `${labelText}${numSheets > 1 ? ` (Sheet ${s})` : ''}`;\n\n        cell.innerHTML = `\n          <span class=\"page-label centered absolute top-2 left-2 px-2 py-1 bg-black text-white text-[10px] font-black rounded uppercase z-10 shadow-[2px_2px_0_black]\">${labelText}${sheetLabel}</span>\n        <button class=\"flip-btn absolute top-2 right-2 w-8 h-8 bg-white hover:bg-yellow-300 border-2 border-black flex items-center justify-center text-sm z-10 shadow-[2px_2px_0_black] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all focus-visible:ring-2 focus-visible:ring-black focus-visible:outline-none\" title=\"Flip ${accessibleLabelText}\" aria-label=\"Rotate ${accessibleLabelText} 180 degrees\">\n              <span class=\"material-symbols-outlined text-lg font-bold\">rotate_right</span>\n          </button>\n          <div class=\"page-placeholder text-gray-200 text-xs font-black uppercase tracking-widest\">Empty</div>\n        <img alt=\"Page ${pageIdx}\" class=\"page-content-img w-full h-full object-contain hidden transition-transform duration-300 ease-in-out\" draggable=\"false\" />\n        `;\n\n        this.setupDragAndDrop(cell);\n        this.setupFlipButton(cell);\n        grid.appendChild(cell);\n      }\n\n      // Guidelines\n      const guidelines = `\n        <div class=\"absolute top-1/2 left-0 w-full border-t border-blue-400/20 pointer-events-none\"></div>\n        <div class=\"absolute top-0 left-1/4 h-full border-l border-blue-400/20 pointer-events-none\"></div>\n        <div class=\"absolute top-0 left-1/2 h-full border-l border-blue-400/20 pointer-events-none\"></div>\n        <div class=\"absolute top-0 left-3/4 h-full border-l border-blue-400/20 pointer-events-none\"></div>\n      `;\n\n      sheetWrapper.appendChild(grid);\n      sheetWrapper.insertAdjacentHTML('beforeend', guidelines);\n      this.elements.zineSheetsContainer.appendChild(sheetWrapper);\n    }\n  }\n\n  setupDragAndDrop(cell) {\n    cell.addEventListener('dragstart', (e) => {\n      e.dataTransfer.setData('text/plain', cell.getAttribute('data-page-index'));\n      cell.classList.add('dragging');\n    });\n\n    cell.addEventListener('dragend', () => {\n      cell.classList.remove('dragging');\n      document.querySelectorAll('.page-cell').forEach(c => c.classList.remove('drag-over'));\n    });\n\n    cell.addEventListener('dragover', (e) => {\n      e.preventDefault();\n      cell.classList.add('drag-over');\n    });\n\n    cell.addEventListener('dragleave', () => {\n      cell.classList.remove('drag-over');\n    });\n\n    cell.addEventListener('drop', (e) => {\n      e.preventDefault();\n      cell.classList.remove('drag-over');\n      const fromIndex = parseInt(e.dataTransfer.getData('text/plain'));\n      const toIndex = parseInt(cell.getAttribute('data-page-index'));\n\n      if (fromIndex !== toIndex) {\n        this.emitter.emit('pagesSwapped', { fromIndex, toIndex });\n      }\n    });\n  }\n\n  updatePagePreview(pageIndex, dataUrl) {\n    // Search in both main container (by data-page-index) and unused grid\n    // Note: Use querySelectorAll to catch duplicates if any, but usually unique by index\n    const cells = [\n      ...Array.from(this.elements.zineSheetsContainer.querySelectorAll(`.page-cell[data-page-index=\"${pageIndex}\"]`)),\n      ...(this.elements.unusedGrid ? Array.from(this.elements.unusedGrid.querySelectorAll(`.page-cell[data-page-index=\"${pageIndex}\"]`)) : [])\n    ];\n\n    cells.forEach(cell => {\n      const img = cell.querySelector('.page-content-img');\n      const placeholder = cell.querySelector('.page-placeholder');\n\n      // Handle \"Unused\" placeholder structure which is different\n      const unusedPlaceholder = cell.querySelector('.text-gray-300'); // The 'Unused' text div\n\n      if (dataUrl) {\n        if (img) {\n          img.src = dataUrl;\n          img.classList.remove('hidden');\n        }\n        if (placeholder) { placeholder.classList.add('hidden'); }\n        // Hide \"Unused\" text if present\n        if (unusedPlaceholder && unusedPlaceholder.textContent === 'Unused') {\n          unusedPlaceholder.classList.add('hidden');\n        }\n      } else {\n        if (img) {\n          img.src = '';\n          img.classList.add('hidden');\n        }\n        if (placeholder) { placeholder.classList.remove('hidden'); }\n        if (unusedPlaceholder && unusedPlaceholder.textContent === 'Unused') {\n          unusedPlaceholder.classList.remove('hidden');\n        }\n      }\n    });\n\n    // Also force show the bucket section if we are populating it\n    if (this.elements.unusedGrid && this.elements.unusedGrid.children.length > 0) {\n      this.elements.unusedSection.classList.remove('hidden');\n    }\n  }\n\n  /**\n   * Setup flip button click handler for a cell\n   */\n  setupFlipButton(cell) {\n    const flipBtn = cell.querySelector('.flip-btn');\n    if (flipBtn) {\n      flipBtn.addEventListener('click', (e) => {\n        e.stopPropagation(); // Prevent drag\n        const pageIndex = parseInt(cell.getAttribute('data-page-index'));\n        this.emitter.emit('pageFlipped', pageIndex);\n      });\n    }\n  }\n\n  /**\n   * Apply flip state to a page\n   */\n  setPageFlip(pageIndex, isFlipped) {\n    const cell = this.elements.zineSheetsContainer.querySelector(`[data-page-index=\"${pageIndex}\"]`);\n    if (cell) {\n      const img = cell.querySelector('.page-content-img');\n      if (img) {\n        if (isFlipped) {\n          img.style.transform = `${img.style.transform || ''} rotate(180deg)`.trim();\n          img.classList.add('flipped');\n        } else {\n          img.style.transform = img.style.transform.replace('rotate(180deg)', '').trim();\n          img.classList.remove('flipped');\n        }\n      }\n    }\n  }\n\n  triggerFileUpload() {\n    this.elements.pdfUpload?.click();\n  }\n\n  handleDragOver(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (this.elements.uploadZone) {\n      this.elements.uploadZone.classList.add('dragover');\n    }\n  }\n\n  handleDragLeave(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (this.elements.uploadZone && !this.elements.uploadZone.contains(e.relatedTarget)) {\n      this.elements.uploadZone.classList.remove('dragover');\n    }\n  }\n\n  handleFileDrop(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (this.elements.uploadZone) {\n      this.elements.uploadZone.classList.remove('dragover');\n    }\n\n    const files = e.dataTransfer.files;\n    if (files.length > 0 && files[0].type === 'application/pdf') {\n      this.emitter.emit('fileSelected', files[0]);\n    } else {\n      toast.error('Invalid File', 'Please drop a valid PDF file');\n    }\n  }\n\n  handleKeyboard(e) {\n    // Global keyboard shortcuts\n    if (e.key === 'p' && (e.metaKey || e.ctrlKey)) {\n      e.preventDefault();\n      this.emitter.emit('print');\n    }\n  }\n\n  showProgress(show, text = 'Processing PDF...', subtext = '') {\n    if (show) {\n      if (this.elements.progressContainer) {\n        this.elements.progressContainer.classList.remove('hidden');\n        this.elements.progressContainer.classList.add('flex');\n      }\n    } else {\n      if (this.elements.progressContainer) {\n        this.elements.progressContainer.classList.add('hidden');\n        this.elements.progressContainer.classList.remove('flex');\n      }\n    }\n\n    if (this.elements.progressText) { this.elements.progressText.textContent = text; }\n    if (this.elements.progressSubtext) { this.elements.progressSubtext.textContent = subtext; }\n  }\n\n  /**\n   * Load settings from localStorage\n   */\n  loadSettings() {\n    const savedPaperSize = localStorage.getItem('paperSize');\n    const savedOrientation = localStorage.getItem('orientation');\n\n    if (savedPaperSize) {\n      this.paperSize = savedPaperSize;\n      if (this.elements.paperSizeSelect) { this.elements.paperSizeSelect.value = savedPaperSize; }\n    }\n\n    if (savedOrientation) {\n      this.orientation = savedOrientation;\n      if (this.elements.orientationSelect) { this.elements.orientationSelect.value = savedOrientation; }\n    }\n  }\n\n  updatePaperSize(paperSize) {\n    this.paperSize = paperSize;\n    localStorage.setItem('paperSize', paperSize);\n    this.updatePreviewLayout();\n    this.emitter.emit('paperSizeChanged', { paperSize, orientation: this.orientation });\n  }\n\n  updateOrientation(orientation) {\n    this.orientation = orientation;\n    localStorage.setItem('orientation', orientation);\n    this.updatePreviewLayout();\n    this.emitter.emit('orientationChanged', { paperSize: this.paperSize, orientation });\n  }\n\n  togglePageNumbers(show) {\n    const labels = document.querySelectorAll('.page-label');\n    labels.forEach(label => {\n      if (show) {\n        label.classList.remove('hidden');\n        label.classList.add('centered'); // Force centered style when shown per user request\n      } else {\n        label.classList.add('hidden');\n        label.classList.remove('centered');\n      }\n    });\n  }\n\n\n  updatePreviewLayout() {\n    const sheets = document.querySelectorAll('.print-sheet');\n    if (!sheets.length) { return; }\n\n    // Get dimensions for the current selection\n    const dims = this.getPaperDimensions(this.paperSize, this.orientation);\n    // Calculate ratio (width / height)\n    const ratio = dims.width / dims.height;\n\n    sheets.forEach(sheet => {\n      // 1. Set Aspect Ratio\n      sheet.style.aspectRatio = `${ratio}`;\n\n      // 2. Fit to Screen Logic\n      // We want the sheet to fit within, say, 75vh to leave room for headers/controls\n      // and max-width 100% of container.\n      sheet.style.maxHeight = '75vh';\n      sheet.style.maxWidth = '100%'; // Ensure it fits in the container width\n      sheet.style.margin = '0 auto'; // Center it\n    });\n  }\n\n  getPaperDimensions(paperSize, orientation) {\n    const size = PAPER_SIZES[paperSize] || PAPER_SIZES.a4;\n\n    if (orientation === 'landscape') {\n      return { width: size.height, height: size.width };\n    }\n\n    return { width: size.width, height: size.height };\n  }\n\n  getPaperSizeLabel(paperSize) {\n    return PAPER_SIZES[paperSize]?.label || 'A4';\n  }\n\n  hasContent() {\n    return this.elements.zineSheetsContainer &&\n      this.elements.zineSheetsContainer.querySelector('.page-content-img:not(.hidden)') !== null;\n  }\n\n  on(event, handler) {\n    this.emitter.on(event, handler);\n  }\n}","export default \"__VITE_ASSET__BJ2yq0m$__\"","import '../styles/index.css';\nimport { PDFProcessor } from './pdf-processor.js';\nimport { UIManager } from './zine-ui.js';\nimport { toast } from './toast.js';\nimport { formatFileSize } from './utils.js';\nimport { jsPDF } from 'jspdf';\nimport html2canvas from 'html2canvas';\n\n// Import assets\nimport referenceImageUrl from '../assets/reference-back-side.jpg';\n\nclass PDFZineMaker {\n  constructor() {\n    this.pdfProcessor = new PDFProcessor();\n    this.ui = new UIManager();\n    this.referenceImageUrl = referenceImageUrl;\n    this.allPageImages = new Array(16).fill(null);\n    this.pageFlips = {}; // Track individual page flips: { pageIndex: true/false }\n    this.gridSize = { rows: 2, cols: 4 }; // Default grid size\n    this.init();\n  }\n\n\n  /**\n   * Initialize the application\n   */\n  async init() {\n    try {\n      await this.pdfProcessor.initialize();\n      this.setupEventListeners();\n      this.ui.generateLayout(8); // Default to 8 pages\n      this.ui.setStatus('Upload a PDF file to get started', 'info');\n    } catch (error) {\n      console.error('Initialization error:', error);\n      this.ui.setStatus('Failed to initialize. Please refresh the page.', 'error');\n      toast.error('Initialization Error', 'Failed to load required libraries.');\n    }\n  }\n\n  /**\n   * Setup event listeners\n   */\n  setupEventListeners() {\n    // UI Events\n    this.ui.on('fileSelected', (file) => this.handleFileSelected(file));\n    this.ui.on('print', () => this.handlePrint());\n    this.ui.on('export', () => this.handleExport());\n    this.ui.on('paperSizeChanged', (data) => this.updatePaperSettings(data));\n    this.ui.on('orientationChanged', (data) => this.updatePaperSettings(data));\n    this.ui.on('pagesSwapped', (data) => this.handlePagesSwapped(data));\n    this.ui.on('pageFlipped', (pageIndex) => this.handlePageFlipped(pageIndex));\n    this.ui.on('gridSizeChanged', (data) => this.handleGridSizeChanged(data));\n  }\n\n  /**\n   * Handle individual page flip\n   */\n  handlePageFlipped(pageIndex) {\n    this.pageFlips[pageIndex] = !this.pageFlips[pageIndex];\n    this.ui.setPageFlip(pageIndex, this.pageFlips[pageIndex]);\n  }\n\n  /**\n   * Handle grid size change\n   */\n  handleGridSizeChanged({ rows, cols }) {\n    this.gridSize = { rows, cols };\n    const totalPages = rows * cols;\n\n    // Generate a custom grid layout\n    this.ui.generateCustomGrid(rows, cols, this.allPageImages.length);\n\n    // Re-apply existing page images\n    for (let i = 0; i < Math.min(totalPages, this.allPageImages.length); i++) {\n      if (this.allPageImages[i]) {\n        this.ui.updatePagePreview(i, this.allPageImages[i]);\n      }\n    }\n  }\n\n\n\n  handleFileSelected(file) {\n    this.selectedFile = file;\n    this.ui.setStatus(`File selected: ${file.name} (${formatFileSize(file.size)})`, 'success');\n    // Start processing immediately on selection for better UX\n    this.processPDF(file);\n  }\n\n  async processPDF(file) {\n    try {\n      toast.info('Reading PDF...', 'Please wait');\n      this.ui.showProgress(true, 'Reading PDF...', '0%');\n\n      const result = await this.pdfProcessor.loadPDF(file, (progress) => {\n        this.ui.updateProgress(progress);\n      });\n\n      const { numPages } = result;\n      this.selectedLayout = numPages; // Allow any number of pages\n      const maxPages = numPages;\n\n      let rows, cols;\n\n      if (numPages === 16) {\n        // Special case for 16-page zine (accordion fold on single sheet)\n        rows = 4;\n        cols = 4;\n        this.gridSize = { rows, cols };\n        this.ui.generateLayout(16, 'accordion-16');\n      } else {\n        // Determine grid size based on page count\n        // Try to find a square-ish grid that fits all pages\n        const sqrt = Math.ceil(Math.sqrt(numPages));\n        // Default to at least 2x4 for small docs, otherwise square-ish\n        rows = numPages <= 8 ? 2 : (sqrt > 2 ? sqrt : 2);\n        cols = numPages <= 8 ? 4 : Math.ceil(numPages / rows);\n\n        // Ensure we don't exceed max grid input (10x10)\n        rows = Math.min(rows, 10);\n        cols = Math.min(cols, 10);\n\n        this.gridSize = { rows, cols }; // Update internal state\n\n        this.allPageImages = new Array(Math.max(rows * cols, numPages)).fill(null);\n        this.ui.generateCustomGrid(rows, cols, this.allPageImages.length);\n      }\n\n      // Update grid inputs to match\n      if (this.ui.elements.gridRows) {\n        this.ui.elements.gridRows.value = rows;\n      }\n      if (this.ui.elements.gridCols) {\n        this.ui.elements.gridCols.value = cols;\n      }\n      if (this.ui.elements.gridTotal) {\n        this.ui.elements.gridTotal.textContent = `(${rows * cols} pages)`;\n      }\n\n      const description = `PDF arranged into a ${rows}×${cols} grid (${rows * cols} pages)`;\n      this.ui.setReady(true, description);\n\n\n\n      // Process pages in parallel\n      const batchSize = 2; // Concurrency limit\n      let completedPages = 0;\n\n      const processPage = async (pageNum) => {\n        const canvas = await this.pdfProcessor.renderPage(pageNum);\n        const url = await this.pdfProcessor.canvasToBlob(canvas);\n\n        // Revoke old URL if it exists\n        if (this.allPageImages[pageNum - 1]) {\n          this.pdfProcessor.revokeBlobUrl(this.allPageImages[pageNum - 1]);\n        }\n\n        this.allPageImages[pageNum - 1] = url;\n        this.ui.updatePagePreview(pageNum - 1, url);\n\n        completedPages++;\n        const percent = Math.round((completedPages / maxPages) * 100);\n        this.ui.showProgress(true, 'Processing Pages...', `${percent}%`);\n        this.ui.updateProgress(percent);\n      };\n\n      for (let i = 1; i <= maxPages; i += batchSize) {\n        const batch = [];\n        for (let j = 0; j < batchSize && (i + j) <= maxPages; j++) {\n          batch.push(processPage(i + j));\n        }\n        await Promise.all(batch);\n      }\n\n      // Fill blanks - using the same blank page logic\n      for (let i = maxPages + 1; i <= (this.selectedLayout); i++) {\n        await this.createBlankPage(i);\n      }\n\n      this.ui.showProgress(false);\n      this.ui.setStatus(`Successfully processed ${numPages} pages`, 'success');\n      toast.success('Done!', 'Your zine is ready to print.');\n\n    } catch (error) {\n      console.error('PDF Error:', error);\n      this.ui.showProgress(false);\n      toast.error('Error', error.message || 'Failed to process PDF.');\n    }\n  }\n\n  async createBlankPage(pageNum) {\n    const canvas = document.createElement('canvas');\n    canvas.width = 1000;\n    canvas.height = 1400;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = '#ffffff';\n    ctx.fillRect(0, 0, 1000, 1400);\n    ctx.fillStyle = '#f3f4f6';\n    ctx.font = 'bold 80px sans-serif';\n    ctx.textAlign = 'center';\n    ctx.fillText('BLANK', 500, 700);\n\n    const url = await this.pdfProcessor.canvasToBlob(canvas);\n\n    // Revoke old URL if it exists\n    if (this.allPageImages[pageNum - 1]) {\n      this.pdfProcessor.revokeBlobUrl(this.allPageImages[pageNum - 1]);\n    }\n\n    this.allPageImages[pageNum - 1] = url;\n    this.ui.updatePagePreview(pageNum - 1, url);\n  }\n\n  handlePagesSwapped({ fromIndex, toIndex }) {\n    // Swap images in array\n    const temp = this.allPageImages[fromIndex];\n    this.allPageImages[fromIndex] = this.allPageImages[toIndex];\n    this.allPageImages[toIndex] = temp;\n\n    // Swap flip states\n    const tempFlip = this.pageFlips[fromIndex];\n    this.pageFlips[fromIndex] = this.pageFlips[toIndex];\n    this.pageFlips[toIndex] = tempFlip;\n\n    // Update previews\n    this.ui.updatePagePreview(fromIndex, this.allPageImages[fromIndex]);\n    this.ui.updatePagePreview(toIndex, this.allPageImages[toIndex]);\n\n    // Update flip UI\n    this.ui.setPageFlip(fromIndex, !!this.pageFlips[fromIndex]);\n    this.ui.setPageFlip(toIndex, !!this.pageFlips[toIndex]);\n\n\n    toast.info('Pages swapped');\n  }\n\n  updateZineView(zineNum) {\n    // Update the UI to show the correct 8 pages for the selected zine (1 or 2)\n    const startPageIndex = (zineNum - 1) * 8;\n    for (let i = 0; i < 8; i++) {\n      const globalPageIndex = startPageIndex + i;\n      const imageUrl = this.allPageImages[globalPageIndex];\n      this.ui.updatePagePreview(i, imageUrl); // Update the 8 visible cells\n    }\n  }\n\n  updatePaperSettings(settings) {\n    this.paperSize = settings.paperSize;\n    this.orientation = settings.orientation;\n  }\n\n  handlePrint() {\n    if (!this.ui.hasContent()) {\n      toast.warning('No Content', 'Upload a PDF to print!');\n      return;\n    }\n\n    // Audit check: Are all pages filled?\n    // We won't block it, but we could warn if it's empty.\n\n    this.createPrintLayout();\n  }\n\n  createPrintLayout() {\n    const printWindow = window.open('', '_blank');\n    if (!printWindow) {\n      toast.error('Blocked', 'Please allow popups.');\n      return;\n    }\n\n\n    const zineSheets = [];\n\n    // Get HTML for all sheets\n    document.querySelectorAll('.zine-grid').forEach(grid => {\n      zineSheets.push(grid.innerHTML);\n    });\n\n    const dimensions = this.ui.getPaperDimensions(this.paperSize || 'a4', this.orientation || 'landscape');\n\n\n    // Dynamic grid CSS based on current settings\n    const { rows, cols } = this.gridSize;\n    const gridCss = `\n      grid-template-columns: repeat(${cols}, 1fr);\n      grid-template-rows: repeat(${rows}, 1fr);\n      grid-template-areas: none !important;\n      /* Generate grid areas if needed, but simple flow usually works for generic grids */\n    `;\n\n    // We rely on the DOM's inline styles for rotation now, \n    // so we don't need hardcoded rotation CSS.\n    // The cut lines are also specific to the old layout, so we'll omit them for generic grids\n    // or maybe add them later if we implement smart cut lines.\n    const cutLinesCss = '';\n\n\n    const cutLinesHtml = '';\n\n    const sheetsHtml = zineSheets.map((content) => `\n      <div class=\"sheet\">\n        <div class=\"zine-grid\">${content}</div>\n        ${cutLinesHtml}\n      </div>\n      <div class=\"sheet\"><div class=\"back-side\"></div></div>\n    `).join('');\n\n    const html = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Print Zine</title>\n        <style>\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          @page { size: ${dimensions.width}mm ${dimensions.height}mm; margin: 0; }\n          body { background: white; width: ${dimensions.width}mm; height: ${dimensions.height}mm; overflow: hidden; }\n          .sheet { width: 100%; height: 100%; page-break-after: always; display: block; overflow: hidden; position: relative; }\n          .zine-grid {\n            display: grid;\n            ${gridCss}\n            height: ${dimensions.height}mm;\n            width: ${dimensions.width}mm;\n            /* Ensure grid fills the page */\n            justify-content: stretch;\n            align-content: stretch;\n          }\n          .page-cell {\n            position: relative;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            overflow: hidden;\n            border: none;\n          }\n          /* Generic page areas fallback if needed */\n          \n          .page-content-img { \n            width: 100%; \n            height: 100%; \n            object-fit: contain; \n            /* Rely on DOM transform for rotation */\n          }\n          .page-label, .page-placeholder { display: none; }\n          \n          .back-side {\n            width: 100%; height: 100%;\n            background-image: url('${this.referenceImageUrl}');\n            background-size: contain;\n            background-position: center;\n            background-repeat: no-repeat;\n            transform: rotate(180deg);\n          }\n          \n          /* CRITICAL: Hide controls in print */\n          @media print {\n            .flip-btn, .page-label, .guidelines, .page-placeholder, .page-cell::before, .page-cell::after { \n                display: none !important; \n            }\n            .page-cell { border: none !important; }\n          }\n          \n          ${cutLinesCss}\n        </style>\n      </head>\n      <body>\n        ${sheetsHtml}\n      </body>\n      </html>\n    `;\n\n    printWindow.document.write(html);\n    printWindow.document.close();\n    printWindow.setTimeout(() => {\n      printWindow.print();\n      printWindow.close();\n    }, 500);\n  }\n\n\n  async handleExport() {\n    if (!this.ui.hasContent()) { return; }\n    try {\n      this.ui.elements.exportPdfBtn.disabled = true;\n      document.body.classList.add('is-exporting'); // Hide UI controls\n      toast.info('Generating PDF...');\n\n      const doc = new jsPDF({\n        orientation: this.orientation || 'landscape',\n        unit: 'mm',\n        format: this.paperSize || 'a4'\n      });\n\n      const dimensions = this.ui.getPaperDimensions(this.paperSize || 'a4', this.orientation || 'landscape');\n\n      const captureZine = async (sheetNum) => {\n        const grid = document.querySelector(`#zine-grid-sheet-${sheetNum}`);\n        if (!grid) { return; }\n\n        await new Promise(r => setTimeout(r, 100)); // Allow DOM to update\n\n        const canvas = await html2canvas(grid, {\n          scale: 2, // Reduced from 3 for performance\n          useCORS: true,\n          backgroundColor: '#ffffff',\n          logging: false\n        });\n\n        if (sheetNum > 1) { doc.addPage(); }\n        doc.addImage(canvas.toDataURL('image/jpeg', 0.95), 'JPEG', 0, 0, dimensions.width, dimensions.height);\n\n        // Add back side\n        doc.addPage();\n        const backCanvas = document.createElement('canvas');\n        backCanvas.width = canvas.width;\n        backCanvas.height = canvas.height;\n        const bctx = backCanvas.getContext('2d');\n        const refImg = new Image();\n        refImg.src = this.referenceImageUrl;\n        await new Promise(r => { refImg.onload = r; });\n\n        bctx.translate(backCanvas.width / 2, backCanvas.height / 2);\n        bctx.rotate(Math.PI);\n        bctx.drawImage(refImg, -backCanvas.width / 2, -backCanvas.height / 2, backCanvas.width, backCanvas.height);\n        doc.addImage(backCanvas.toDataURL('image/jpeg', 0.9), 'JPEG', 0, 0, dimensions.width, dimensions.height);\n      };\n\n      await captureZine(1);\n      // Only capture second sheet for dual-16 template (not accordion-16 which is single sheet)\n      if (this.currentTemplate !== 'accordion-16' && this.selectedLayout > 8) {\n        await captureZine(2);\n      }\n\n      doc.save(`zine-${Date.now()}.pdf`);\n      toast.success('Downloaded!', 'Your PDF is ready.');\n    } catch (e) {\n      console.error(e);\n      toast.error('Export Failed', 'Something went wrong.');\n    } finally {\n      this.ui.elements.exportPdfBtn.disabled = false;\n      document.body.classList.remove('is-exporting'); // Restore UI controls\n    }\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  new PDFZineMaker();\n});"],"names":["debounce","func","wait","timeout","args","later","isNumber","value","formatFileSize","bytes","units","size","unitIndex","pdfWorker","PDFProcessor","pdfjsLib.GlobalWorkerOptions","file","errors","maxSize","onProgress","validation","loadingPromise","pdfjsLib.getDocument","timeoutPromise","_","reject","numPages","error","buffer","data","pageNum","page","viewport","width","height","canvas","context","renderContext","resolve","blob","url","format","quality","message","mitt","n","t","e","PAPER_SIZES","ZINE_TEMPLATES","Toast","type","title","duration","toast","role","icon","iconDiv","contentDiv","titleDiv","messageDiv","closeBtn","rotation","icons","UIManager","$","selector","id","_a","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","updateGridSize","rows","cols","debouncedHandleGridChange","_l","_m","ready","description","percent","templateType","template","totalPDFPages","totalSlots","actualPages","sheetWrapper","grid","i","cell","labelText","startIndex","totalPages","unusedSection","unusedGrid","img","label","placeholder","item","_template","numSheets","pageIdx","sheetLabel","accessibleLabelText","guidelines","c","fromIndex","toIndex","pageIndex","dataUrl","unusedPlaceholder","flipBtn","isFlipped","files","show","text","subtext","savedPaperSize","savedOrientation","paperSize","orientation","sheets","dims","ratio","sheet","event","handler","referenceImageUrl","PDFZineMaker","result","progress","maxPages","sqrt","batchSize","completedPages","processPage","batch","j","ctx","temp","tempFlip","zineNum","startPageIndex","globalPageIndex","imageUrl","settings","printWindow","zineSheets","dimensions","gridCss","cutLinesCss","cutLinesHtml","sheetsHtml","content","html","doc","jsPDF","captureZine","sheetNum","r","html2canvas","backCanvas","bctx","refImg"],"mappings":"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","x_google_ignoreList":[1,3]}